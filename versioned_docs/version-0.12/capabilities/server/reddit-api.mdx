import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Overview

The Reddit API allows you to read and write Reddit content such as posts / comments / upvotes, in order to integrate your app's behavior with the content of the community it's installed in.

## The Reddit client

Here's how to obtain a reference to the Reddit client

<Tabs>
  <TabItem value="web" label="Devvit Web">
  ```json title="devvit.json"
  {
    "permissions": {
      "reddit": true
    }
  }
  ```
  ```ts title="server/index.ts"
  import { reddit } from '@devvit/reddit';
  ```
  </TabItem>
  <TabItem value="blocks" label="Devvit Blocks / Mod Tools">
  ```ts title="devvit.tsx"
  import { Devvit } from '@devvit/public-api';
  
  Devvit.configure({
    redditAPI: true,
  });

  //Then, in any function that has a reference to Devvit.Context:
  const reddit = context.reddit;
  ```
  </TabItem>
</Tabs>

## Reddit Thing IDs

Reddit uses prefixed IDs (called "things") to identify different types of content:

| Prefix | Type | Example | Description |
| ------ | ---- | ------- | ----------- |
| `t1_` | Comment | `t1_abc123` | A comment on a post or reply to another comment |
| `t2_` | User | `t2_xyz789` | A Reddit user account |
| `t3_` | Post | `t3_def456` | A post |
| `t4_` | Message | `t4_ghi012` | A private message |
| `t5_` | Subreddit | `t5_jkl345` | A subreddit community |

These IDs are returned by API methods and used when referencing specific content:

```ts
// Get a post by its full ID
const post = await reddit.getPostById('t3_abc123');

// Get a comment by its full ID  
const comment = await reddit.getCommentById('t1_xyz789');

// A comment's parentId can be either a post (t3_) or another comment (t1_)
const parentId = comment.parentId; // 't3_abc123' or 't1_def456'
```

## Example usage

### Submitting a post
<Tabs>
  <TabItem value="web" label="Devvit Web">
  ```ts
import { Devvit } from '@devvit/public-api';
import { context, reddit } from '@devvit/web/server';

export const createPost = async () => {
  const { subredditName } = context;
  if (!subredditName) {
    throw new Error('subredditName is required');
  }

  return await reddit.submitCustomPost({
    userGeneratedContent: {
      text: 'Hello there! This is a post from a Devvit app',
    },
    subredditName: subredditName,
    title: 'New Post',
    entry: 'default',
  });
};
  ```
</TabItem>
  <TabItem value="blocks" label="Devvit Blocks / Mod Tools">

```tsx
import { Devvit } from '@devvit/public-api';

Devvit.configure({
  redditAPI: true,
});

function createPost(context: Devvit.Context) {
  const currentSubreddit = context.reddit.getCurrentSubreddit();
  if (!currentSubreddit) {
    throw new Error('No subreddit found');
  }

  return context.reddit.submitPost({
    title: 'My custom post',
    subredditName: currentSubreddit.name,
    preview: (
      <vstack height="100%" width="100%" alignment="middle center">
        <text size="large">Loading...</text>
      </vstack>
    ),
  });
}
```
</TabItem>
</Tabs>

### Submitting a comment

:::note
Auto-comments should be used to spark conversation in the post comments, but you should avoid lower-signal updates (e.g., level/progress pings).
:::


<Tabs>
    <TabItem value="web" label="Devvit Web">
    ```ts
        import { context, reddit } from '@devvit/web/server';

        export const createComment = async () => {
            const { subredditName } = context;
            if (!subredditName) {
                throw new Error('subredditName is required');
            }

            reddit.submitComment({
                postId: 't3_123456', // Replace with the actual post ID
                text: 'This is a comment from a Devvit app',
                runAs: 'USER' // Optional: specify the user to run as
            });
        };
```
    </TabItem>
    <TabItem value="blocks" label="Devvit Blocks / Mod Tools">
    ```tsx
        import { Devvit } from '@devvit/public-api';

        Devvit.configure({
            redditAPI: true,
        });

        function createComment(context: Devvit.Context) {
            const { reddit } = context;

            reddit.submitComment({
                postId: 't3_123456', // Replace with the actual post ID
                text: 'This is a comment from a Devvit app',
                runAs: RunAs.USER, // Optional: specify the user to run as
            });
        };
```
    </TabItem>
</Tabs>
